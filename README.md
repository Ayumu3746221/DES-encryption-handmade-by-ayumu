# DES 暗号 実装

C++ で実装した Data Encryption Standard (DES) アルゴリズムによる暗号化／復号機能を提供します。

## 目次

- [DES 暗号 実装](#des-暗号-実装)
  - [目次](#目次)
  - [はじめに](#はじめに)
  - [アーキテクチャ](#アーキテクチャ)
  - [モジュール](#モジュール)
    - [BitUtils](#bitutils)
    - [テーブル定義](#テーブル定義)
    - [KeySchedule](#keyschedule)
    - [FeistelFunction](#feistelfunction)
    - [暗号化／復号フロー](#暗号化復号フロー)
  - [テストと検証](#テストと検証)
  - [今後の展望](#今後の展望)

## はじめに

**目的**: C++ で DES の暗号化・復号を実装し、16 ラウンドの Feistel ネットワークを通じて安全にデータを変換します。

**範囲**:

* 初期／逆初期置換 (IP, IP\_INV)
* 16 ラウンド Feistel 構造による暗号化／復号化
* 鍵スケジュールによるサブキー生成

## アーキテクチャ

* **`DES` クラス**: 暗号化および復号のメイン API
* **ディレクトリ構成**:

  ```plaintext
  src/
  ├── BitUtils.hpp/cpp       # ビット操作ユーティリティ
  ├── Tables.hpp             # IP, IP_INV, E, S_BOXES, P, PC1, PC2 定義
  ├── KeySchedule.hpp/cpp    # サブキー生成
  ├── FeistelFunction.hpp/cpp# Feistel ラウンド関数
  ├── DES.hpp/cpp            # DES クラス
  └── tests/
      └── TestVectors.cpp    # テストベクタ検証
  ```

## モジュール

### BitUtils

* ビット抽出・挿入
* マスク操作
* 28/32/48/56/64 ビットの分割・結合

### テーブル定義

`static constexpr` 配列で以下を定義:

* 初期置換 (IP)
* 逆初期置換 (IP\_INV)
* 拡張関数 (E)
* 8 つの S-Box
* P パーミュテーション
* PC-1 / PC-2

### KeySchedule

* PC-1 による 56 ビット鍵の抽出
* 28 ビット半分をラウンドごとに循環シフト
* PC-2 による 48 ビットサブキー生成
* `std::array<uint64_t, 16>` に格納

### FeistelFunction

* 32 ビット入力 → E 拡張 → 48 ビット
* サブキーと XOR → 各 6 ビットチャンクを S-Box で 4 ビットに置換
* 32 ビット再構成 → P パーミュテーション

### 暗号化／復号フロー

1. 64 ビット入力に IP 適用 → L0, R0
2. 16 ラウンド:

   * 暗号化: サブキーを順序通り適用
   * 復号化: サブキーを逆順に適用
3. 最終ラウンド後に左右を入れ替え → R16||L16
4. IP\_INV 適用 → 出力

## テストと検証

* NIST 公開の DES テストベクタを使用して正確性を確認
* Google Test によるユニットテスト:

  * モジュール単位テスト (BitUtils, FeistelFunction など)
  * エンドツーエンドの暗号化／復号テスト

## 今後の展望

* ブロック暗号モード (ECB, CBC, CTR など) の実装
* DES-X, 3DES 対応
* AES との性能・安全性比較

> **備考**: 学習目的の個人プロジェクトのため、ライセンスは明示していません。再利用の際は各自の判断でご対応ください。
> このプロジェクトまたはプロジェクト内のソースコードによる、いかなる損害や賠償の責任は負いかねます。
